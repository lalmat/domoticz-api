var DomoticzApi;(()=>{"use strict";var e={d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function s(e){return"undefined"==typeof window?n:function(e){return btoa(e)}(e)}function n(e){Buffer.from(e,"base64")}e.r(t),e.d(t,{Domoticz:()=>y,DomoticzApiProvider:()=>i,DomoticzApiProviderFetch:()=>r,deviceHumidityGeneralTypes:()=>o,deviceHumidityTypes:()=>c,deviceTypes:()=>a,notificationTypes:()=>h,useCameras:()=>d,useDevices:()=>u,useEvents:()=>m,useNotifications:()=>l,useScenes:()=>p,useSystem:()=>v});class i{constructor(e,{username:t,password:s,useSSL:n,port:i}){this.hostname=e,this.username=t,this.password=s,this.useSSL=n,this.port=i,this.endpoint=this.url("json.htm")}url(e){return`http${this.useSSL?"s":""}://${this.hostname}:${this?.port?this.port:this?.useSSL?443:80}/${e}${this?.username&&this?.password?`?username=${s(this.username)}&password=${s(this.password)}`:"?username=&password="}`}cameras(e){return this.domoticz({type:"cameras",...e})}command(e){return this.domoticz({type:"command",...e})}devices(e){return this.domoticz({type:"devices",...e})}events(e){return this.domoticz({type:"events",...e})}notifications(e){return this.domoticz({type:"notifications",...e})}scenes(e){return this.domoticz({type:"scenes",...e})}setUsed(e){return this.domoticz({type:"setUsed",...e})}checkCredentials(){return this.__generic("GET",`${this.url("json.htm")}&api-call`)}get(e){return this.__generic("GET",this.url(`${e}`))}domoticz(e){return this.__generic("GET",this.endpoint,e)}__generic(e,t,s,n){}}class r extends i{async __generic(e,t,s,n=null){const i=s?Object.entries(s).reduce(((e,[t,s])=>`${e}&${encodeURI(t)}=${encodeURI(s)}`),""):"",r={method:e,headers:{Accept:"application/json","Content-Type":"application/json"},body:n?JSON.stringify(n):null},a=`${t}${i}`,o=await fetch(a,r);return await o.json()}}const a={LIGHT:"light",WEATHER:"wheather",TEMP:"temp",UTILITY:"utility",WIND:"wind",RAIN:"rain",UV:"uv",BARO:"baro",ZWAVEALARM:"zwavealarm",ALL:"all"},o={STABLE:0,SUNNY:1,CLOUDY:2,UNSABLE:3,THUNDERSTORM:4,UNKNOWN:5,CLOUDY_RAIN:6},c={HEAVY_SNOW:0,SNOW:1,HEAVY_RAIN:2,RAIN:3,CLOUDY:4,SOME_CLOUDS:5,SUNNY:6,UNKNOWN:7,UNSTABLE:8,STABLE:9};function u(e){return{items:()=>e.devices({used:!0,displayhidden:1}),getByIdx:t=>e.devices({rid:t}),getByType:(t,s="Name")=>!!function(e,t){const s=null!=Object.values(e).find((e=>e==t));return s||console.log("DeviceType not found",t),s}(a,t)&&e.devices({filter:t,used:!0,order:s}),getFavorites:()=>e.devices({used:!0,filter:"all",favorite:1}),switch:(t,s="On")=>e.command({param:"switchlight",idx:t,switchcmd:"on"===s.toLowerCase()?"On":"Off"}),toggle:t=>e.command({param:"switchlight",idx:t,switchcmd:"Toggle"}),rename:(t,s)=>e.command({param:"renamedevice",idx:t,name:s}),protect:(t,s=!0)=>e.setUsed({used:!0,idx:t,protected:s?"true":"false"}),updateTemperature(e,t){return this.updateDevice(e,t)},updateHumidity(e,t,s){return t<0||t>100||s<0||s>5?null:this.updateDevice(e,s,t)},async updateBarometer(e,t,s){return this.updateDevice(e,`${t};${s}`)},updateDevice:(t,s,n=0)=>e.command({param:"udevice",idx:t,svalue:s,nvalue:n})}}function d(e){return{items:()=>e.cameras()}}function m(e){return{items:()=>e.events({param:"list"})}}function p(e){return{items:()=>e.scenes(),switch:(t,s)=>e.command({param:"switch",idx:t,switchcmd:s}),toggle(e){return this.switch(e,"Toggle")}}}const h={NULL:"<null>",BROWSER:"browser",FCM:"fcm",HTTP:"http",KODI:"kodi",LMS:"lms",NMA:"nma",PROWL:"prowl",PUSHALOT:"pushalot",PUSHBULLET:"pushbullet",PUSHOVER:"pushover",PUSHSAFER:"pushsafer",TELEGRAM:"telegram"};function l(e){return{send(t,s,n=""){const i={param:"sendnotification",subject:t,body:s};if(""!=n){if(r=n,null==Object.values(h).find(r))return;i.subSystem=n}var r;return e.command(i)}}}function v(e){return{log:t=>e.command({param:"addlogmessage",message:`DOMOTICZ API : ${t}`}),async checkCredentials(){try{return await e.checkCredentials(),!0}catch(e){return!1}},securityStatus:()=>e.command({param:"getsecstatus"}),version:()=>e.command({param:"getversion"}),datetimes:()=>e.command({param:"getSunRiseSet"}),reboot:()=>e.command({param:"system_reboot"}),shutdown:()=>e.command({param:"system_shutdown"}),db_backup:()=>e.get("backupdatabase.php"),db_vaccum:()=>e.command({param:"vaccumdatabase"})}}function y(e,t){const s=t?.api?new t.api(e,t):new r(e,t);return{cameraManager:d(s),deviceManager:u(s),eventManager:m(s),notificationManager:l(s),sceneManager:p(s),systemManager:v(s)}}DomoticzApi=t})();