var DomoticzApi;(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{function s(e){return"undefined"==typeof window?i:function(e){return btoa(e)}(e)}function i(e){Buffer.from(e,"base64")}e.r(t),e.d(t,{DomoticzApi:()=>c,DomoticzApiProviderFetch:()=>a,deviceTypes:()=>n,useDevices:()=>o});class r{constructor(e,{username:t,password:s,useSSL:i,port:r}){this.hostname=e,this.username=t,this.password=s,this.useSSL=i,this.port=r,this.endpoint=this.url("json.htm?_connector=domoticz-api")}url(e){return`http${this.useSSL?"s":""}://${this.hostname}:${this.port?this.port:this.useSSL?443:80}/${e}&username=${s(this.username)}&password=${s(this.password)}`}cameras(e){return this.domoticz({type:"cameras",...e})}command(e){return this.domoticz({type:"command",...e})}devices(e){return this.domoticz({type:"devices",...e})}events(e){return this.domoticz({type:"events",...e})}notifications(e){return this.domoticz({type:"notifications",...e})}scenes(e){return this.domoticz({type:"scenes",...e})}setUsed(e){return this.domoticz({type:"setUsed",...e})}get(e){return this.__generic("GET",this.url(e))}domoticz(e){return this.__generic("GET",this.endpoint,e)}__generic(e,t,s,i){}}class a extends r{async __generic(e,t,s,i=null){const r=Object.entries(s).reduce(((e,[t,s])=>`${e}&${encodeURI(t)}=${encodeURI(s)}`),""),a={method:e,headers:{Accept:"application/json","Content-Type":"application/json"},body:i?JSON.stringify(i):null},n=await fetch(`${t}${r}`,a);return await n.json()}}const n={LIGHT:"light",WEATHER:"wheather",TEMP:"temp",UTILITY:"utility",WIND:"wind",RAIN:"rain",UV:"uv",BARO:"baro",ZWAVEALARM:"zwavealarm",ALL:"all"};function o(e){return{all:()=>e.devices({used:!0,displayhidden:1}),get(){return this.all()},getByIdx:t=>e.devices({rid:t}),getByType(t,s="Name"){return i=t,null!=Object.values(n).find(i)&&e.devices({filter:t,used:!0,order:s});var i},getFavorites:()=>e.devices({used:!0,filter:"all",favorite:1}),change:(t,s="On")=>e.command({param:"switchlight",idx:t,switchcmd:"on"===s.toLowerCase()?"On":"Off"}),toggle:t=>e.command({param:"switchlight",idx:t,switchcmd:"Toggle"}),rename:(t,s)=>e.command({param:"renamedevice",idx:t,name:s}),protect:(t,s=!0)=>e.setUsed({used:!0,idx:t,protected:s?"true":"false"}),updateTemperature(e,t){return this.updateDevice(e,t)},updateHumidity(e,t,s){return t<0||t>100||s<0||s>5?null:this.updateDevice(e,s,t)},updateBarometer(e,t,s){return this.updateDevice(e,`${t};${s}`)},updateDevice:(t,s,i=0)=>e.command({param:"udevice",idx:t,svalue:s,nvalue:i})}}class c{constructor(e,t){const s=new a(e,t);this.devices=o(s),this.cameras=new class{constructor(e){this.api=e}all(){return this.api.cameras()}get(){return this.all()}}(s),this.events=new class{constructor(e){this.api=e}all(){return this.api.events({param:"list"})}get(){return this.all()}}(s),this.scenes=new class{constructor(e){this.api=e}all(){return this.api.scenes()}get(){return this.all()}switch(e,t){return this.api.command({param:"switch",idx:e,switchcmd:t})}toggle(e){return this.switch(e,"Toggle")}}(s),this.notification=new class{constructor(e){this.api=e}send(e,t,s=""){return this.api.command({param:"sendnotification",subject:e,body:t,subsystem:s})}}(s),this.system=new class{constructor(e){this.api=e}log(e){return this.api.command({param:"addlogmessage",message:`############# DOMOTICZ API ############# => ${e}`})}version(){return this.api.command({param:"getversion"})}datetimes(){return this.api.command({param:"getSunRiseSet"})}reboot(){return this.api.command({param:"system_reboot"})}shutdown(){return this.api.command({param:"system_shutdown"})}db_backup(){return this.api.get("backupdatabase.php")}db_vaccum(){return this.api.command({param:"vaccumdatabase"})}}(s)}}})(),DomoticzApi=t})();